---
author: Jiangtang Hu
title: XML and SAS
excerpt:
layout: post
category:
  - CDISC
  - SAS
  - XML
tags:
  - CDISC
  - Perl Regular Expression
  - SAS
  - XML
post_format: [ ]
---
Last month, I gave a talk, *XML: the SAS Approach*, in [CDISC Interchange China 2010][1](at the Medical School of Fudan University, Shanghai, 2010-09-15). [FDA][2] favors [CDISC][3] and [HL7][4], the two XML based standards, and SAS programmers in biopharmaceutical industry  need incorporate the XML technology into their toolboxes. Fortunately, you don’t need to be an XML expert then to play XML in your daily work, and, SAS system DOES offer multiple tools and applications to handle XML files, i.e. import and export XML data:

*   SAS data steps approach:                        import and export 
*   [SAS XML Libname engine][5]:                         import and export 
*   [SAS ODS XML statement][6](ODS MARKUP):   export 
*   [PROC CDISC][7]:                                            import and export 
*   [SAS XML Mapper][8]:                                      import 
*   [SAS CDISC Viewer][9]:                           *as if*  import 

The [SAS CDISC Viewer][9] and [PROC CDISC][7] procedure are some bit toys, and the rest really work. The Perl Regular Expression(PRX) approach is also presented to export and import XML data. 

A simple demo. First, use FILE and PUT statements to generate an XML file:

> data \_null\_;   
>     file "export.xml";   
>     put ‘<?xml version="1.0" encoding="windows-1252" ?>’;   
>     put ‘<ROWSET>’;   
>     put ‘<ROW>’;   
>     put ‘<text> Welcome to CDISC Interchange 2010 China </text>’;   
>     put ‘</ROW>’;   
>     put ‘<ROW>’;   
>     put ‘<text> We are in Shanghai! </text>’;   
>     put ‘</ROW>’;   
>     put ‘</ROWSET>’;    
> run;

Then read the whole XML file to SAS dataset:

> data import0 ;   
>     infile "export.xml" dsd missover truncover lrecl = 1024;   
>     input line $1024.;   
>     if line = ” then delete;   
> run;

Third step, extract the information you want(the text between <text> and </text> tags) using  Perl Regular Expression:

> data import (keep = line );   
>      retain queName ;   
>      retain line ;   
>      set import0;      
> 
>      /*use PRX to capture the structure of XML data;*/   
>      If \_n\_=1 then do;   
>             queName=prxparse(‘/^<text> /’);   
>      end;   
>      queNameN=prxmatch(queName,line); 
> 
>     /*use PRX to remove the XXML tags;*/   
>      if queNameN>0 then do;   
>         rx1=prxparse("s/<.*?>//");   
>         call prxchange(rx1,99,line);   
>         output;   
>      end;        
> run;

The logic of PRX approach to process XML data is very simple and can be easily modified according to your needs:

*   complicate and utilize the PRX codes to capture the hierarchical structure of XML data. 
*   remove XML tags and output the information to SAS dataset.

 [1]: http://www.cdisc.org/interchange-china#2329
 [2]: http://www.fda.gov/
 [3]: http://www.cdisc.org/
 [4]: http://www.hl7.org/
 [5]: http://support.sas.com/rnd/base/xmlengine/sxle913/index.html
 [6]: http://support.sas.com/rnd/base/ods/odsmarkup/odsxml/
 [7]: http://support.sas.com/rnd/base/cdisc/proccdisc/index.html
 [8]: http://www.sas.com/apps/demosdownloads/92_SDL_sysdep.jsp;jsessionid=75E543A04B4ED91EFE8B8D16B73954A1.tc4j3apps1?packageID=000513&jmpflag=N
 [9]: http://www.sas.com/apps/demosdownloads/cdiscviewer_PROD__sysdep.jsp;jsessionid=75E543A04B4ED91EFE8B8D16B73954A1.tc4j3apps1?packageID=000343&jmpflag=N